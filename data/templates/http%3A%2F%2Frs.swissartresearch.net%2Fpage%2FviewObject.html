[[> partial:pageHeader]]
[[> partial:contentHeader]]

<h2><mp-label iri="[[#if objectiri]][[objectiri]][[else]][[ urlParam 'objectiri' ]][[/if]]"></mp-label></h2>

[[> partial:fieldsTable iri=objectiri param="objectiri" ]]
<semantic-link
    iri="[[#if objectiri]][[objectiri]][[else]][[ urlParam 'objectiri' ]][[/if]]"
><button type="button" class="btn btn-primary btn-xs">View raw</button></semantic-link>

[[#if objectiri]]
[[objectiri]]
    [[> partial:buttonEditObjectMeta iri=objectiri]]
[[else]]
    [[> partial:buttonEditObjectMeta iri=(urlParam 'objectiri')]]
[[/if]]

<semantic-table
    query="SELECT DISTINCT ?image ?IIIFimage WHERE {
        <[[#if objectiri]][[objectiri]][[else]][[ urlParam 'objectiri' ]][[/if]]> crm:P128_carries ?work .
        ?work la:digitally_shown_by ?image .
        OPTIONAL {
            ?image la:digitally_available_via/la:access_point ?IIIFimage
        }
    }"
    number-of-displayed-rows="100"
    tuple-template="{{> template }}"
>
    <template id="template">
        <bs-panel>
            {{#if IIIFimage.value }}
                <semantic-link
                    uri="[[ resolvePrefix 'page:viewImage']]"
                    urlqueryparam-imageiri="{{IIIFimage.value}}"
                    >
                    {{> thumbnail}}
                </semantic-link>
            {{ else }}
                {{> thumbnail}}
            {{/if}}
        </bs-panel>
    </template>
    <template id="thumbnail">
        <mp-resource-thumbnail iri="{{ image.value }}">
            <mp-resource-thumbnail-fallback>
                <span>Image not found!</span>
            </mp-resource-thumbnail-fallback>
        </mp-resource-thumbnail>
    </template>
</semantic-table>
[[> partial:contentFooter]]
[[> partial:pageFooter]]