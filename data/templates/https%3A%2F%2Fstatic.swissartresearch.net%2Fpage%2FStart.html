[[> partial:pageHeader]]
[[> partial:contentHeader]]

<div class="bso-component home-search">
    <bs-col md="10" md-offset="1">
        <div class="bso-component simple-search">
            <semantic-simple-search
                query="
                SELECT ?resource ?label ?typeLabel WHERE {
                ?resource a ?type ;
                    rdfs:label ?label .
                ?type rdfs:label ?typeLabel .
                VALUES(?type){
                    (search:Person)
                    (search:Object)
                    (search:Place)
                    (search:Type)
                }
                ?label bds:search ?__token__ .
                } LIMIT 10"
            template='{{>template}}'
            input-placeholder='Search for something'
            >
                <template id="template">
                    <span title="{{resource.value}}">{{label.value}} ({{typeLabel.value}})</span>
                </template>
            </semantic-simple-search>
        </div>
    </bs-col>
</div>

<div class="bso-component separator panel">
    <bs-row>
        <bs-col md="2">
            <h3>Images</h3>
            [[> resourceSummary type='search:Object' label='images']]
        </bs-col>
        <bs-col md="10" class="bso-component card-container">
            [[#> cards type='search:Object' ]]
            [[/ cards]]
        </bs-col>
    </bs-row>
</div>

<div class="bso-component separator panel">
    <bs-row>
        <bs-col md="2">
            <h3>Places</h3>
            [[> resourceSummary type='search:Place' label='places']]
        </bs-col>
        <bs-col md="10" class="bso-component card-container">
            [[#> cards type='search:Place' ]]
            [[/ cards]]
        </bs-col>
    </bs-row>
</div>

[[#*inline "cards"]]
    <semantic-query
    query="SELECT ?subject WHERE {
        ?subject a [[type]] .
        BIND(SHA512(CONCAT(STR(RAND()), STR(?subject))) AS ?random) .
        [[> @partial-block ]]
    } ORDER BY ?random LIMIT 10"
    template="{{> template-image-summary}}"
    >
    <template id="template-image-summary">
        {{#each bindings}}
            {{> partial:cardObject iri=subject.value}}
        {{/each}}
    </template>
    </semantic-query>
[[/inline]]

[[#*inline "imageSummary"]]
    <semantic-query
    query="SELECT ?subject WHERE {
        ?subject a [[type]] .
        [[> @partial-block ]]
    } LIMIT 20"
    template="{{> template-image-summary}}"
    >
    <template id="template-image-summary">
        <div>
            {{#each bindings}}
                <div class="bso-component mini-thumbnail">
                    <semantic-link
                        uri="{{subject.value}}"
                        urlqueryparam-view="page"
                    >
                        <mp-resource-thumbnail iri={{subject.value}}></mp-resource-thumbnail>
                    </semantic-link>
                </div>
            {{/each}}
        </div>
    </template>
    </semantic-query>
[[/inline]]

[[#*inline "resourceSummary"]]
    <semantic-query
        query="SELECT (COUNT(?subject) as ?num) WHERE {
            ?subject a [[type]] .
        }"
        template="{{#each bindings}}There are currently {{num.value}} [[label]] in the database.{{/each}}"
    ></semantic-query>
[[/inline]]

[[> partial:pageFooter]]
[[> partial:contentFooter]]
